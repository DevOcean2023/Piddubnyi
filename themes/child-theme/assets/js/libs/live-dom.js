export default function n(n,e){p(n)||console.error("Invalid Selector",n);const o={},i={top:250,bottom:250},t=[];let s=null,c=!1,r=null,l="ready",d=[],u=[];const f={onceInit:null,onceShow:null,onceAlways:null,onceHide:null},a={firstInit:null,firstShow:null,firstAlways:null,firstHide:null},h={onceInit:null,onceShow:null,onceAlways:null,onceHide:null,init:null,firstShow:null,show:null,firstAlways:null,always:null,firstHide:null,hide:null},w={init:null,firstShow:null,show:null,firstAlways:null,always:null,firstHide:null,hide:null},y={doneFirst:{always:[],show:[],hide:[]},doneOnce:{init:!1,always:!1,show:!1,hide:!1}},b={onceInit:I,onceShow:S,onceAlways:A,onceHide:m,init:H,firstShow:v,show:O,firstHide:$,hide:E,firstAlways:g,always:x,dependency:M,setMargin:F};function p(n){try{document.createDocumentFragment().querySelector(n)}catch(n){return!1}return!0}if(e)for(const n in e)b[n](e[n]);function I(n,e=!0){h.onceInit=n,f.onceInit=e,N()}function S(n,e=!0){h.onceShow=n,f.onceShow=e,N()}function A(n,e=!0){h.onceAlways=n,f.onceAlways=e,N()}function m(n,e=!0){h.onceHide=n,f.onceHide=e,N()}function H(n,e=!1,o=!0){h.init=n,a.firstInit=e,!0===o&&N()}function v(n,e=!1,o=!0){h.firstShow=n,a.firstShow=e,!0===o&&N()}function O(n){h.show=n}function $(n,e=!1,o=!0){h.firstHide=n,a.firstHide=e,!1===o&&N()}function E(n){h.hide=n}function g(n,e=!1,o=!0){h.firstAlways=n,a.firstAlways=e,!1===o&&N()}function x(n){h.always=n}function M(n){r=n,l="not_ready"}function F([n=250,e=250]){i.top=n,i.bottom=e}function _(n){t.includes(n)||(t.push(n),L(n),!1===c&&("undefined"==typeof IntersectionObserver?q(n):function(n){let e=!1;o[n]=new IntersectionObserver((([o])=>{e||o.intersectionRatio>0?(e=!0,o.isIntersecting?j(n,"show"):!1===o.isIntersecting&&j(n,"hide"),j(n,"always")):e=!0}),{rootMargin:`${i.bottom}px 0px ${i.top}px 0px`,threshold:[.01]}),o[n].observe(n)}(n)))}function q(n){const e=()=>{l="ready",q(n)},i=e=>{o[n].unobserve(n),e&&console.error(e)};"ready"===l?Object.keys(h).forEach((e=>{w[e]&&h[e].bind(n)(),h[e]&&h[e].bind(n)()})):"not_ready"===l&&(l="process",r(e,i))}function L(n){if(h.init||w.init||h.onceInit){const e=()=>{l="ready",u.forEach((n=>L(n))),u=[]},i=e=>{o[n].unobserve(n),e&&console.error(e)};if("ready"===l){if(h.onceInit)return void(!1===y.doneOnce.init&&(y.doneOnce.init=!0,h.onceInit.bind(n)(),f.onceInit&&T()));w.init&&w.init.bind(n)(),h.init&&h.init.bind(n)()}else"not_ready"===l?(l="process",u.push(n),r(e,i)):"process"===l&&u.push(n)}}function j(n,e){if("ready"===l){const i=e.charAt(0).toUpperCase()+e.slice(1);h[`once${i}`]&&!1===y.doneOnce[e]&&(y.doneOnce[e]=!0,h[`once${i}`].bind(n)(),f[`once${i}`]&&T()),y.doneFirst[e].includes(n)||(y.doneFirst[e].push(n),w[`first${i}`]&&w[`first${i}`].bind(n)(),h[`first${i}`]&&(h[`first${i}`].bind(n)(),a[`first${i}`]&&o[n].unobserve(n))),w[e]&&w[e].bind(n)(),h[e]&&h[e].bind(n)()}else if("not_ready"===l){const i=()=>{l="ready",d.forEach((({element:n,type:e})=>{j(n,e)})),d=[]},t=e=>{o[n].unobserve(n),e&&console.error(e)};l="process",d.push({type:e,element:n}),r(i,t)}else"process"===l&&d.push({type:e,element:n})}function N(){if(null===s&&p(n)){s=new MutationObserver((e=>{e.forEach((e=>{"childList"===e.type&&e.addedNodes.length&&e.addedNodes.forEach((e=>{e instanceof HTMLElement&&(e.matches(n)&&_(e),e.querySelectorAll(n).forEach((n=>{_(n)})))}))}))}));const e=()=>{document.body?(s.observe(document.body,{subtree:!0,childList:!0}),document.querySelectorAll(n).forEach((n=>_(n)))):window.setTimeout(e,50)};e()}}function T(){c=!0,s.disconnect(),t.forEach((n=>{void 0!==o[n]&&o[n].unobserve(n)}))}return Object.freeze({onceInit:I,onceShow:S,onceAlways:A,onceHide:m,init:H,firstShow:v,show:O,firstHide:$,hide:E,firstAlways:g,always:x,dependency:M,setMargin:F})}