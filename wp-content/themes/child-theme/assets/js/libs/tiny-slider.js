import e from "./live-dom";import t from "./dom-ready";import n from "./tiny-slide-counter";let s;const r=[];export function createSlider(e, t){let r=null,d=Array.from(e.cloneNode(!0).children),i=null,l=null,o=null;const a={},c=window.matchMedia("(prefers-reduced-motion: no-preference)");t.container=e,c.matches||(t.autoplay=!1),a.getItems=()=>d,a.setItems= e=>{d=e,a.getTns().destroy(),a.setIsUpdated(!0)},a.getElement=()=>e,a.setElement= t=>(e=t,a),a.getIsFiltered=()=>i,a.setIsFiltered= e=>(i=e,a),a.getIsSort=()=>l,a.setIsSort= e=>(l=e,a),a.getIsUpdated=()=>o,a.setIsUpdated= e=>(o=e,a),a.getData=()=>r,a.setData= e=>(r=e,a),a.filter=function(){a.getTns().destroy(),a.setIsFiltered(!0)},a.sort=function(){a.getTns().destroy(),a.setIsSort(!0)},a.setElement(e);let p=s(t);return n(t.displayCounter||!1,p),a.getTns=()=>p,a.rebuildTns=function(){p=p.rebuild(),n(t.displayCounter||!1,p)},a.runActions=function(){a.getIsUpdated()?(a.getElement().innerHTML="",a.getElement().append(...a.getItems()),a.rebuildTns(),a.setIsUpdated(!1)):a.getIsFiltered()?(a.getElement().innerHTML="",a.getElement().append(...a.getItems().filter((e=>t.filter({slider:a,item:e})))),a.rebuildTns(),a.setIsFiltered(!1)):a.getIsSort()&&(a.getElement().append(...a.getItems().sort(((e, n)=>t.sort({slider:a,a:e,b:n})))),a.rebuildTns(),a.setIsSort(!1))},a}export function sliderDependencyCallback(e, t){"function"==typeof s?e():import("./tiny").then((t=>{s=t.default,e()})).catch(t)}export function tinySlider(n, s={}, d=(()=>{})){let i;i="function"==typeof s?s:function(e){if(void 0!==e.dataset.tnsSliderId)r[e.dataset.tnsSliderId].setElement(e).runActions();else{e.dataset.tnsSliderId=r.length.toString();const t=createSlider(e,s);r.push(t),d(t)}},t((()=>{e(n,{dependency:sliderDependencyCallback,firstShow(){i(this)}})}))}
