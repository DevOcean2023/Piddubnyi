import e from "./menu-tooltip";import{setCloseEvents as t,open as n,openTypes as o}from "./menu-helpers";export default function r(r){r.addEventListener("keyup",(()=>{if(!0===JSON.parse(localStorage.getItem("acsbState")||"{}")?.actions?.keyNav?.enabled)return;const l="auto-close"===r.dataset.keyboardMenu,i=void 0!==r.dataset.expendMenu,a=Array.from(r.querySelectorAll(":scope > li > a")),s=[];function c(e, t, n, o){const r=Array.from(e.querySelectorAll(":scope > ul > li > a"));r.forEach(((l, i)=>{const a=u(l);l.addEventListener("keydown",(l=>{f(l,t,n,r,i,e,a,"vertical",o)})),a&&(c(a,r,i,o),s.push(a))}))}function f(e, t, r, l, s, c, f, u, d=!1){let g=!1;const h=e.key,m="horizontal"===u?"ArrowLeft":"ArrowUp",b="horizontal"===u?"ArrowDown":"ArrowRight",p="horizontal"===u?"ArrowUp":"ArrowLeft";if(("horizontal"===u?"ArrowRight":"ArrowDown")===h){const e=s+1;l[e>=l.length?0:e].focus(),g=!0}else if(m===h){const e=s-1;l[e<0?l.length-1:e].focus(),g=!0}else if(b===h){if(f)i&&n(f,"keyboard"),f.querySelector("a").focus(),g=!0;else if(!1!==d){const e=d+1;a[e>=a.length?0:e].focus(),g=!0}}else t.length&&p===h&&(t[r].focus(),g=!0);g&&(e.preventDefault(),c&&i&&o.set(c,"keyboard"))}function u(e){if(e.nextElementSibling){if("DIV"===e.nextElementSibling.tagName)return e.nextElementSibling;if(e.nextElementSibling.nextElementSibling&&"DIV"===e.nextElementSibling.nextElementSibling.tagName)return e.nextElementSibling.nextElementSibling}return!1}a.forEach(((e, t)=>{const n=u(e);if(e.addEventListener("keydown",(e=>f(e,[],!1,a,t,!1,n,"horizontal"))),n){const e=t-1;c(n,a,e<0?a.length-1:e,t),s.push(n)}})),s.forEach((e=>{t(e,"keyboard",l)})),e(r,!!s.length,r.className.includes("header")?"header":"footer")}),{once:!0})}
